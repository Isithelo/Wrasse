<div class="container">
<div class="row" style="padding-top: 25px">
	<div class="col-md-3" id="navMenuPanel">       
		{{> usernav billing-payfast=true}}
	</div>  
	<div class="col-md-9" id="browserArea">
		{{#if messages.success}}
		<div role="alert" class="alert alert-success">
			{{#each messages.success}}
			<div>{{msg}}</div>
			{{/each}}
		</div>
		{{/if}}
		{{#if messages.error}}
		<div role="alert" class="alert alert-danger">
			{{#each messages.error}}
			<div>{{msg}}</div>
			{{/each}}
		</div>
		{{/if}}
		<h3>Billing</h3>
		<hr>
		<h4>Plan</h4>
		{{#if user.plan.payfast.payment_status}}
		<div class="well">
			<strong>Developer</strong>, Unlimited private repositories</strong>
		</div>
		<a class="btn btn-danger" onclick="cancel_subscriptionModal()" data-toggle="modal" data-target="#myModal"><i class="fa fa-ban" aria-hidden="true"></i> Cancel Subscription</a>
		{{else}}
		<div class="well">
			<strong>Free plan</strong>, unlimited public repositories</strong>
		</div>
		<p><a class="btn btn-outline-secondary mt-4" href="/users/{{user.username}}/settings/billing/upgrade_payfast">Get private repositories</a></p>
		{{/if}}		
		</div>
	</div>
	<!-- Modal -->
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		<div class="modal-dialog" role="document">
			<div class="modal-content"  id="modalTextArea">
			</div>
		</div>
	</div>
 
 

 
 	<script type="text/javascript">
function cancel_subscriptionModal(){
	var html = '<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel"><i class="fa fa-trash" aria-hidden="true"></i> Cancel Subscription.</h4> </div> <div class="modal-body"> <p>Are you sure you wish to cancel this subscription?</p> <div style="text-align: center"> <div id="modelHtml"></div> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button> </div>'
	$('#modalTextArea').html(html)
	$('#modelHtml').html('<a onclick="post_cancel()"  class="btn btn-danger">Cancel Subscription.</a>')
}

function post_cancel(){
$('#modelHtml').html('<div style="text-align:center;padding:25px"><i class="fa fa-spinner fa-pulse"></i> Loading</div>')	
$.ajax({
  url: '/payment_cancel_req',
  success: function(data){
   $('#modelHtml').html(data)	
  },
  error:function(err){
  	 $('#modelHtml').html(err)	
  }
});
}

////////////////////////
///// INITIALIZE //////
//////////////////////
$(document).ready( function() {
 
});

</script></div>
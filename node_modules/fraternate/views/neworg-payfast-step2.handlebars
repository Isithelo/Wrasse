<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="msvalidate.01" content="6F54F88A443C656EFB178CEF11C4E7E9" />
  <meta name="google-site-verification" content="V6ZQykcqytIxvH_JCfowxQfGXB9Qn-rgaQ-iIrtoW3c" />
  <title>{{pagetitle}}</title>
  {{> css}}
</head>
<body>
  {{> javascript}}
 
  <style type="text/css">
    .success-steps{
      background-color: #0366d9;
      color:white;
    }
    .success-td{
      background-color: white;
      color: #0366d9;
    }

    .spinner {
      width: 100px;
    }
    .spinner input {
      text-align: right;
    }
    .input-group-btn-vertical {
      position: relative;
      white-space: nowrap;
      width: 1%;
      vertical-align: middle;
      display: table-cell;
    }
    .input-group-btn-vertical > .btn {
      display: block;
      float: none;
 
 
 
      font-size: 6px;
   
      position: relative;
      border-radius: 0;
    }
    .input-group-btn-vertical > .btn:first-child {
      border-top-right-radius: 4px;
    }
    .input-group-btn-vertical > .btn:last-child {
      margin-top: -2px;
      border-bottom-right-radius: 4px;
    }
    .input-group-btn-vertical i{
      position: absolute;
      top: 0;
      left: 4px;
    }
  </style>
  <div class="container">
    <div class="row mt-3">
      <div class="col align-self-center">
        <div class="card" >
          <div class="card-body">
           <div style="text-align: center">
            <a href="/">
             <img src="/img/Logo square 300x300.png" style="height: 55px">   
           </a>
         </div>
         <div style="text-align: center;padding-bottom: 15px">
          <h4>Create an organization account.</h4> 
        </div> 

        <table class="table table-bordered" style="border-radius: 5px"> 
          <tr>
            <td style="padding-bottom: 22px;width: 25%;text-align: center;color:grey" >
             <h3 ><i class="fa fa-check" aria-hidden="true"  ></i> <strong class="step" style="font-size:24px"> Step 1</strong></h3>
             Create Organization
           </td>
           <td style="padding-bottom: 22px;width: 25%;text-align: center;" class="success-steps">
             <h3 ><strong class="step" style="font-size:24px"> Step 2</strong></h3>
             Choose your plan 
           </td>
           <td style="padding-bottom: 22px;width: 25%;text-align: center;color:grey" >
            <h3><strong class="step" style="font-size:24px"> Step 3</strong></h3>
            Tailor your experience
          </td>
          <td style="padding-bottom: 22px;width: 25%;text-align: center;color:grey">
           <h3>  Step 4</strong></h3>
           Invite members 
         </td>
       </tr>
     </table>

     {{#if messages.errors}}
     <div role="alert" class="alert alert-danger">
      {{#each messages.errors}}
      {{#each errors}}
      <div>{{msg}}</div>
      {{/each}}
      {{/each}}
    </div>
    {{/if}}
    {{#if messages.success}}
    <div role="alert" class="alert alert-success">
      {{#each messages.success}}
      <div>{{msg}}</div>
      {{/each}}
    </div>
    {{/if}}
    {{#if messages.error}}
    <div role="alert" class="alert alert-danger">
      {{#each messages.error}}
      <div>{{msg}}</div>
      {{/each}}
    </div>
    {{/if}}


    <!-- Multiple Radios -->
    <div class="form-group">
      <label for="radios" class="col-12 display-4">Choose your plan</label>
  
        <ul class="list-group">
          <div class="list-group-item">
            <input type="radio" name="radios" id="radios-0" value="1" checked="checked" class="free" >
            <strong>Free</strong>
            <div class="row">
              <div class="col-9">
               <p class="help-block">Unlimited organizational users, public components and assemblies.</p>
             </div>
             <div class="col-12" style="text-align: right;">
              <h3>ZAR 0.00</h3>
            </div>
            <div id="button" class="col-12">
              <div >
                <a href='/organizations/new-payfast-step3/{{organization.entry.name}}'  class="btn btn-outline-success">Continue</a><small>
                </small>
              </div>
              <div >
              </div>
            </div>
          </div>
        </div>
        <div class="list-group-item">
          <input type="radio" name="radios" id="radios-1" value="2"  class="teampay">
          <strong>Team</strong>
          <div class="row">
            <div class="col-12">
             <p class="help-block">Starts at ZAR 400.00 / month which includes your first 5 users.</p>
             <p class="help-block">Unlimited organizational users, public components and assemblies.</p>
             <p class="help-block">Unlimited organizational users, private components and assemblies.</p>
           </div>
           <div class="col-12" style="text-align: right;">
            <h3>ZAR 100.00
              per user
            / month</h3>
          </div>
        </div>
        <br/>
        <div class="hiddenInput">  
          <div class="row">
           <div class="col-2">
            <div class="input-group spinner ">
              <input name="users" id="users" type="text" class="form-control" value="5">
              <div class="input-group-btn-vertical">
                <button class="btn btn-outline-secondary" type="button"><i class="fas fa-plus"></i></button>
                <button class="btn btn-outline-secondary" type="button"><i class="fas fa-minus"></i></button>
              </div>
            </div>
          </div>
          <div class="col-10">
           <label for="users" class="col-10">users in this team plan</label>
         </div>
         <div class="col-12">
          <p></p>
          <table class="table table-bordered">
            <tr>
              <td>5 base users <small>(minimum)</small></td>
              <td class="success-td">ZAR 400.00
              / month</td>
            </tr>
            <tr id="extrauser">
            </tr>
            <tr id="total">
              <td><strong> For <span id="count">5</span> users, you’ll pay</strong></td>
              <td class="success-td"><strong>ZAR <span id="price">400.00</span>
              / month</strong></td>
            </tr>
          </table>
        </div>
      </div>
      <div id="payment">
        <div class="row">
        </div> 
        <div>
 
            <input type="checkbox" name="bbn" id="bbn" class="showHideCheck " />This account is owned by a business (see the <a href="/terms">Terms of Service</a> for details)
            <div class="hiddenInputs">  
              <br>
              <p>What is the name of the business that owns this account?</p>
              <input type="text"  name="custom_str2" id="custom_str2"  class="form-control" >
              <p class="help-block">e.g, Acme, Inc.</p>
              <div >
                <small>The credit card and plan you choose will be billed to the organization — not <strong>{{user.username}}</strong> (your user account). This business — not <strong>{{user.username}}</strong> (your user account), will own and/or control any content posted to the organization account </small>
              </div>
            </div>
            <br/>
          
        </div>
      </div>
      <table class="table table-bordered">
        <tr style="display: none">
          <td>Invoice Number: </td>
          <td>
            <input class="form-control" type="text" name="payment_id" id="payment_id" value="{{organization._id}}" />
          </td>
        </tr>
        <tr style="display: none">
          <td>User Email: </td>
          <td>
            <input class="form-control" type="text" name="custom_str1" id="custom_str1" value="{{user.email}}" />
          </td>
        </tr>
      </table>                
      <div id='buttonss'></div>
      <p></p>
      <small class="text-muted">By clicking "Subscribe Now via PayFast",  up, you agree to the <a href="/terms">Terms of Service</a> and <a href="/Privacy">Privacy Statement</a>. You will be forwarded to the PayFast payment gateway.</small>  
    </div>
  </div>

</ul>
</div>
</div>
</div>
</div> 
</div>
</div>
</div>
</div>   

<script type="text/javascript">



  $(".hiddenInput").hide();
  $(".hiddenInputs").hide();
  $("#payment").hide();
  $(".showHideCheck").on("change", function() {
    $this = $(this);
    $input = $this.parent().find(".hiddenInputs");
    if($this.is(":checked")) {
      $input.slideDown();
    } else {
      $input.slideUp();
    }
  });
  $(".teampay").on("change", function() {
    $this = $(this);
    $input = $this.parent().find(".hiddenInput");
    if($this.is(":checked")) {
      $input.slideDown();
      $('#payment').slideDown();
    } else {
      $input.slideUp();
      $('#payment').slideUp();
    }
    if($this.is(":checked")) {
      $('#button').slideUp();
    } else {
      $('#button').slideDown();
    }

  });
  $(".free").on("change", function() {
    $this = $(this);
    $input = $(".teampay").parent().find(".hiddenInput");
    $input.slideUp();
    $('#payment').slideUp();
    if($this.is(":checked")) {
      $('#button').slideDown();
    } else {
      $('#button').slideDown();
    }
  });
  jQuery.fn.extend({
    disable: function(state) {
      return this.each(function() {
        var $this = $(this);
        $this.toggleClass('disabled', state);
      });
    }
  });
  $("#name").on("keyup", function() {
    var value = $( this ).val();
    var invalidChars = [  ];
    var name = new RegExp('^[A-Za-z]+$');
    if(value.match(name)) {
      $("#insert").html($("#name").val())
      $('#submits').prop('disabled', false);
      $("#nameGroup").removeClass('has-error')
      $('#errmsg').html('')
    } else {
      $("#nameGroup").addClass('has-error')
      $('#submits').prop('disabled', true);
      $('#errmsg').html('Username may only contain alphanumeric characters or single hyphens, and cannot begin or end with a hyphen.')
    }
  })
  $("#name").on("change", function() {
    var value = $( this ).val();
    var invalidChars = [  ];
    var name = new RegExp('^[A-Za-z]+$');
    if(value.match(name)) {
      $("#insert").html($("#name").val())
      $('#submits').prop('disabled', false);
      $("#nameGroup").removeClass('has-error')
      $('#errmsg').html('')
    } else {
      $("#nameGroup").addClass('has-error')
      $('#submits').prop('disabled', true);
      $('#errmsg').html('Username may only contain alphanumeric characters or single hyphens, and cannot begin or end with a hyphen.')
    }
  })
  var checkout;
  var checkout1;
  $('#radios-1').click(function(){
    $('#collapseExample').collapse()
    var button = document.querySelector('#submits');
  })
  $('#radios-0').click(function(){
  })
  $('.spinner .btn:first-of-type').on('click', function() {
    $('.spinner input').val( parseInt($('.spinner input').val(), 10) + 1);
    $('#count').html($('.spinner input').val())
    var basePrice = 400
    var userPrice = 100
    var count = $('.spinner input').val()
    if (count>5) {
      var price = ((count - 5)*userPrice)+basePrice
      $('#price').html(price+'.00')
      $('#amount').val(price)
      buttonUpdate(price)
    } else {
      $('#price').html(basePrice+'.00')
      $('#amount').val(basePrice)
      buttonUpdate(basePrice)
    }
  });
  $('.spinner .btn:last-of-type').on('click', function() {
    $('.spinner input').val( parseInt($('.spinner input').val(), 10) - 1);
    $('#count').html($('.spinner input').val())
    var basePrice = 400
    var userPrice = 100
    var count = $('.spinner input').val()
    if (count>5) {
      var price = ((count - 5)*userPrice)+basePrice
      $('#price').html(price+'.00')
      $('#amount').val(price)
      buttonUpdate(price)
    } else {
      $('#price').html(basePrice+'.00')
      $('#amount').val(basePrice)
      buttonUpdate(basePrice)
    }
  });
  var amount = '400.00'
/////////////////////////////
//////  INTITIALIZE  ///////
///////////////////////////
$('document').ready(function(){
  buttonUpdate(amount)
})


$('#custom_str2').change(function(){
  buttonUpdate(amount)
})

////////////////////////////////
//////  ADD THE BUTTON  ///////
//////////////////////////////
function buttonUpdate(amount){
  var billingname = $('#custom_str2').val()
  $('#buttonss').html( '<a href="{{URLPAYFAST}}?cmd=_paynow&amp;receiver={{MERCHANTIDPAYFAST}}&amp;item_name=Subscription&amp;item_description=Subscribe+to+this+site.&amp;amount='+amount+'&amp;return_url={{website}}organizations/new-payfast-step3/{{organization.entry.name}}&amp;cancel_url={{website}}payment_org_cancelled&amp;notify_url={{website}}payment_org_notify&amp;cycles=0&amp;frequency=6&amp;m_subscription_id=pay_now_12600984&amp;m_payment_id={{organization._id}}&amp;payment_id={{organization._id}}&amp;custom_str1={{{user.email}}}&amp;custom_str2='+billingname+'&amp;subscription_type=1"><img src="https://www.payfast.co.za/images/buttons/dark-large-subscribe.png" width="210" height="59" alt="Subscribe" title="Subscribe Now with PayFast"  /></a>')
}
</script>
{{> analytics}}
</body>
</html>
///////////////////////////////////////////////
////     SET YOUR APP.JSON DETAILS        //// 
/////////////////////////////////////////////
//Not working ? try double dots on the json url..
var myModule = require('../../../app.json');
var sitename = myModule.sitename
var website = myModule.website
var description = myModule.description
var repo = myModule.repo
var wrasseModel = require('../models/wrasse.js'); 
var express =require('express');
///////////////////////////////////////////////
///////   CREATE AND EDIT AN ENTRY    ////////
/////////////////////////////////////////////
exports.create = function(req, res) {
if (req.user) {
  //express validator required
//user login in check required
var dataset =JSON.parse(JSON.stringify(req.body))
console.log(dataset,'Start create') //The dataset
if (typeof(dataset._id) == "undefined"||dataset._id == ""){
  delete dataset._id;
  dataset.username = req.user.username
  
  var create = new wrasseModel(dataset)
  create.save(function (err, doc) {  
    if (err) {
      console.log('Creating records failed')
    } else{
      console.log('Saving of this issue was successful')
      res.redirect(req.headers['referer']);
    }
  }); }
  else{
    wrasseModel.findOneAndUpdate({ _id: req.body._id }, req.body, { new: true }, function (err, doc){
      if (err) {
        console.log('Updating records failed')
      } else{
  //res.redirect('employee/list');
  console.log('Updating of this issue was successful');
  res.redirect(req.headers['referer']);
}
});
  };
} else {
  res.redirect('/404')
}


}
